/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.37.0.
 * Original file: /npm/@turf/line-split@7.2.0/dist/esm/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{geojsonRbush as r}from"../geojson-rbush@7.2.0/8d6139d6.js";import{square as e}from"../square@7.2.0/9e29a8a2.js";import{bbox as t}from"../bbox@7.2.0/8d64fe90.js";import{truncate as n}from"../truncate@7.2.0/c6c7893a.js";import{lineSegment as o}from"../line-segment@7.2.0/b4b7acd8.js";import{lineIntersect as i}from"../line-intersect@7.2.0/f0a0b5a4.js";import{nearestPointOnLine as u}from"../nearest-point-on-line@7.2.0/84873fda.js";import{getType as f,getCoords as s,getCoord as a}from"../invariant@7.2.0/671cab78.js";import{flattenEach as m,featureEach as l,featureReduce as c}from"../meta@7.2.0/c0f2fe64.js";import{featureCollection as p,lineString as h}from"../helpers@7.2.0/28807c9c.js";function g(r,e){if(!r)throw new Error("line is required");if(!e)throw new Error("splitter is required");var t=f(r),o=f(e);if("LineString"!==t)throw new Error("line must be LineString");if("FeatureCollection"===o)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===o)throw new Error("splitter cannot be a GeometryCollection");var u=n(e,{precision:7});switch(o){case"Point":return w(r,u);case"MultiPoint":return v(r,u);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return v(r,i(r,u,{ignoreSelfIntersections:!0}))}}function v(n,o){var i=[],u=r();return m(o,(function(r){if(i.forEach((function(r,e){r.id=e})),i.length){var o=u.search(r);if(o.features.length){var f=d(r,o);i=i.filter((function(r){return r.id!==f.id})),u.remove(f),l(w(f,r),(function(r){i.push(r),u.insert(r)}))}}else(i=w(n,r).features).forEach((function(r){r.bbox||(r.bbox=e(t(r)))})),u.load(p(i))})),p(i)}function w(e,t){var n=[],i=s(e)[0],u=s(e)[e.geometry.coordinates.length-1];if(b(i,a(t))||b(u,a(t)))return p([e]);var f=r(),m=o(e);f.load(m);var l=f.search(t);if(!l.features.length)return p([e]);var g=d(t,l),v=c(m,(function(r,e,o){var i=s(e)[1],u=a(t);return o===g.id?(r.push(u),n.push(h(r)),b(u,i)?[u]:[u,i]):(r.push(i),r)}),[i]);return v.length>1&&n.push(h(v)),p(n)}function d(r,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var t,n=1/0;return l(e,(function(e){var o=u(e,r).properties.dist;o<n&&(t=e,n=o)})),t}function b(r,e){return r[0]===e[0]&&r[1]===e[1]}var E=g;export{E as default,g as lineSplit};
